services:
  - type: web
    name: klubhouse-pos-api
    env: node
    rootDir: .
    plan: starter
    buildCommand: |
      npm install --include=dev
      npm run prisma:generate --workspace apps/api
      npm run prisma:migrate --workspace apps/api
      npm run build --workspace apps/api
    startCommand: npm run start --workspace apps/api
    envVars:
      - key: TZ
        value: America/Santiago
      - key: postgresql://klubhouse_pos_db_user:q8fzWvJv1OVCcPxOhLQc3XsV7iuVZQPD@dpg-d5eqjnsjebjc73e0kl10-a/klubhouse_pos_db
        sync: false
      - key: b4b6b9e9b7a14b3a9dbf7c2a2a0f1c3d7b6c9e1a2f4d8c0b1a6e9d2c5f7a8b1c
        sync: false
      - key: f1d2c3b4a5968778695a4b3c2d1e0f9a8b7c6d5e4f3a2b1c0d9e8f7a6b5c4d3e
        sync: false
      - key: CORS_ORIGINS
        value: "https://klubhouse-pos-web.onrender.com"

  - type: web
    name: klubhouse-pos-web
    env: node
    rootDir: .
    plan: starter
    buildCommand: |
      npm install --include=dev
      npm run build --workspace apps/web
    startCommand: npm run start --workspace apps/web
    envVars:
      - key: NEXT_PUBLIC_API_URL
        value: "https://klubhouse-pos-api.onrender.com"

